---
layout: guide
group: guide
subtopic: true
title: GraphQL Subscriptions
version: 6
---

# 1-Minute Overview

We'll be leveraging the [elide-spring-boot-example]() project to illustrate how to use subscriptions.

## Decorate an Elide Model

Any Elide model can be made a topic that can be subscribed to by simply annotating it:  

```java
@Include(name = "group")
@Subscription
@Data
public class ArtifactGroup {
    @Id
    private String name;

    @SubscriptionField
    private String commonName;

    @SubscriptionField
    private String description;

    @SubscriptionField
    @OneToMany(mappedBy = "group")
    private List<ArtifactProduct> products;
}
```

The subscription annotation takes zero or more _operations_.  

```java
@Include
@Subscription(operation = { CREATE, UPDATE, DELETE });
class Book {
  ...
}
```

Whenever a model is manipulated (created, deleted, or updated), elide will post a JSON serialized model to a JMS topic for that operation.  Only the fields decorated with `@SubscriptionField` will be serialized (and hence available to be consumed in the subscription).  It is also possible to define [custom operations]() that are triggered by your service business logic.

## Configure a JMS Message Broker

Elide leverages JMS to post subscription messages.  The example project runs an embedded (in-memory broker).  You will want to replace this with a dedicated broker in production.

The application.yaml file to configure an activemq JMS message broker:
```yaml
spring:
  activemq:
    broker-url: 'vm://embedded?broker.persistent=false,useShutdownHook=false'
    in-memory: true
```

## Run Queries

Elide subscriptions are implemented using websockets.  Websockets require a protocol to send and receive messages.  Elide supports the [graphql-ws](https://github.com/enisdenjo/graphql-ws) protocol.  This protocol works both with the Apollo GraphQL client as well as Graphiql.

Elide's subscription API is similar to its API for queries and mutations, but there are some notable differences.  More details about the API can be found [later] in this document.

### Simple Query

Query for newly added 'groups' returning their name and description:

```
subscription { group(topic : ADDED) { name description } }
```

The response will look like:

```json
{
  "data": {
    "group": {
      "name": "new group",
      "description": "foo"
    }
  }
}

```

If there are errors, they will get reported in an errors field:

```json
{
  "data": {
    "group": {
      "name": "new group",
      "commonName": "",
      "nope": null
    }
  },
  "errors": [
    {
      "message": "Exception while fetching data (/group/nope) : ReadPermission Denied",
      "locations": [
        {
          "line": 2,
          "column": 53
        }
      ],
      "path": [
        "group",
        "nope"
      ],
      "extensions": {
        "classification": "DataFetchingException"
      }
    }
  ]
}
```

### Filtering

All elide subscriptions support RSQL filtering that is identical to [filtering for queries and mutations]():

```
subscription { group(topic : ADDED, filter: "name=com.yahoo.elide") { name description } }
```

## Custom 

While Elide makes it easy to subscribe to model manipulations (create, update, and delete), it is also possible to add a subscription topic for something tied to your business logic.


## Dependencies

## Recommendations


